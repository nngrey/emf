.container
  %h2 Results
  .row
    .col-sm-4
      %h4 Response totals
    .col-sm-4
      %h4 View as pie chart
    .col-sm-4
      %h4 View as bar chart
  %br
  %ol
    - @survey_template.data_questions.each do |question|
      - data_hash = {}
      .row
        .col-sm-4
          %li
            = question.description
            %ul
              - question.options.each do |option|
                %li
                  = "#{option.description} - "
                  - if ['Yes / No', 'True / False', 'Multiple choice'].include? question.question_type
                    - survey_response = SurveyResponse.response_total(question.id, option.description)
                    = survey_response
                    - data_hash[option.description] = survey_response
                  - else
                    %ol
                      - SurveyResponse.where(data_question_id: question.id).each do |answer|
                        %li= answer.input_value
          %br
          = semantic_form_for question do |f|
            = f.input :display_value, label: "Display on dashboard as:", :as => :select, :collection => ['Do not display', 'Text', 'Pie chart', 'Bar chart'], :input_html => {:class => 'display_format', data: {id: question.id} }

        - if data_hash.any?
          .col-sm-4
            = pie_chart data_hash, width: "175px", height: "175px"
          .col-sm-4
            = bar_chart data_hash, width: "175px", height: "175px"

      %hr